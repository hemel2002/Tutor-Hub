<!DOCTYPE html>
<html lang="en">
  <head data-mdb-theme="dark">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Complaints Dashboard</title>

    <!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
      rel="stylesheet"
    />
    <!-- Material Design Bootstrap -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.3.2/mdb.min.css"
      rel="stylesheet"
    />
    <!-- MDB Scripts -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.3.2/mdb.umd.min.js"
      defer
    ></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <style>
      body {
        font-family: 'Poppins', sans-serif;
        overflow-x: hidden;
      }

      .navbar {
        background-color: #343a40;
        color: white;
      }

      .navbar .navbar-brand {
        color: #fff;
      }

      .navbar .nav-link {
        color: #ddd;
      }

      .navbar .nav-link:hover {
        color: #fff;
      }

      .sidebar {
        width: 250px;
        position: fixed;
        top: 56px;
        left: 0;
        height: 100%;
        background-color: #f8f9fa;
        border-right: 1px solid #ddd;
        padding-top: 20px;
      }

      .sidebar .nav-link {
        color: #333;
        padding: 10px 20px;
      }

      .sidebar .nav-link:hover {
        background-color: #e9ecef;
        color: #000;
      }

      .main-content {
        margin-left: 250px;
        padding: 20px;
      }

      @media (max-width: 768px) {
        .sidebar {
          position: absolute;
          left: -250px;
          transition: left 0.3s;
        }

        .sidebar.open {
          left: 0;
        }

        .main-content {
          margin-left: 0;
        }
      }

      .navbar-toggler {
        border: none;
      }
    </style>
  </head>

  <body>
    <!-- Include Header -->
    <%- include('header') %> <%- include('side_navbar') %>

    <div class="main-content">
      <h3 class="mb-4">Complaints Dashboard</h3>
      <div class="mb-3">
        <input
          type="text"
          class="form-control"
          placeholder="Search complaints by ID, user, or type..."
          id="searchInput"
        />
      </div>
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead class="table-dark">
            <tr>
              <th>ID</th>
              <th>User</th>
              <th>Email ID</th>
              <th>Complaint</th>
              <th>Account Type</th>
              <th>Status</th>
              <th>Date</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="complaintsTable">
            <!-- Complaints will be dynamically rendered here -->
            <tr>
              <td>1</td>
              <td>Hemal</td>
              <td>hemal@example.com</td>
              <td>Late session</td>
              <td>Student</td>
              <td><span class="badge badge-warning">Pending</span></td>
              <td>2025-01-12</td>
              <td>
                <button
                  class="btn btn-success btn-sm"
                  onclick="resolveComplaint(1)"
                >
                  Resolve
                </button>
                <button
                  class="btn btn-danger btn-sm"
                  onclick="deleteComplaint(1)"
                >
                  Delete
                </button>
                <button class="btn btn-info btn-sm" onclick="viewProfile(1)">
                  View Profile
                </button>
              </td>
            </tr>
            <tr>
              <td>2</td>
              <td>John</td>
              <td>john@example.com</td>
              <td>Unresponsive tutor</td>
              <td>Student</td>
              <td><span class="badge badge-warning">Pending</span></td>
              <td>2025-01-13</td>
              <td>
                <button
                  class="btn btn-success btn-sm"
                  onclick="resolveComplaint(2)"
                >
                  Resolve
                </button>
                <button
                  class="btn btn-danger btn-sm"
                  onclick="deleteComplaint(2)"
                >
                  Delete
                </button>
                <button class="btn btn-info btn-sm" onclick="viewProfile(2)">
                  View Profile
                </button>
              </td>
            </tr>
            <tr>
              <td>3</td>
              <td>Jane</td>
              <td>jane@example.com</td>
              <td>Incorrect billing</td>
              <td>Parent</td>
              <td><span class="badge badge-warning">Pending</span></td>
              <td>2025-01-14</td>
              <td>
                <button
                  class="btn btn-success btn-sm"
                  onclick="resolveComplaint(3)"
                >
                  Resolve
                </button>
                <button
                  class="btn btn-danger btn-sm"
                  onclick="deleteComplaint(3)"
                >
                  Delete
                </button>
                <button class="btn btn-info btn-sm" onclick="viewProfile(3)">
                  View Profile
                </button>
              </td>
            </tr>
            <tr>
              <td>4</td>
              <td>Mike</td>
              <td>mike@example.com</td>
              <td>Technical issues</td>
              <td>Tutor</td>
              <td><span class="badge badge-warning">Pending</span></td>
              <td>2025-01-15</td>
              <td>
                <button
                  class="btn btn-success btn-sm"
                  onclick="resolveComplaint(4)"
                >
                  Resolve
                </button>
                <button
                  class="btn btn-danger btn-sm"
                  onclick="deleteComplaint(4)"
                >
                  Delete
                </button>
                <button class="btn btn-info btn-sm" onclick="viewProfile(4)">
                  View Profile
                </button>
              </td>
            </tr>
            <tr>
              <td>5</td>
              <td>Sarah</td>
              <td>sarah@example.com</td>
              <td>Late session</td>
              <td>Student</td>
              <td><span class="badge badge-warning">Pending</span></td>
              <td>2025-01-16</td>
              <td>
                <button
                  class="btn btn-success btn-sm"
                  onclick="resolveComplaint(5)"
                >
                  Resolve
                </button>
                <button
                  class="btn btn-danger btn-sm"
                  onclick="deleteComplaint(5)"
                >
                  Delete
                </button>
                <button class="btn btn-info btn-sm" onclick="viewProfile(5)">
                  View Profile
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <script>
      const complaintsTable = document.getElementById('complaintsTable');
      const searchInput = document.getElementById('searchInput');

      function resolveComplaint(id) {
        alert(`Complaint ${id} resolved.`);
        // Add logic to mark the complaint as resolved in your backend
      }

      function deleteComplaint(id) {
        alert(`Complaint ${id} deleted.`);
        // Add logic to delete the complaint in your backend
      }

      searchInput.addEventListener('input', (e) => {
        const value = e.target.value.toLowerCase();
        const rows = complaintsTable.querySelectorAll('tr');
        rows.forEach((row) => {
          const cells = row.querySelectorAll('td');
          const matches = Array.from(cells).some((cell) =>
            cell.textContent.toLowerCase().includes(value)
          );
          row.style.display = matches ? '' : 'none';
        });
      });
    </script>
  </body>
</html>
